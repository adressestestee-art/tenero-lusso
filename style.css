// Fonction pour le carrousel d'images d'arrière-plan
function startCarousel() {
    const images = document.querySelectorAll('.carousel-bg img');
    if (images.length === 0) return;

    let currentIndex = 0;
    setInterval(() => {
        images[currentIndex].classList.remove('active');
        currentIndex = (currentIndex + 1) % images.length;
        images[currentIndex].classList.add('active');
    }, 5000); // Change l'image toutes les 5 secondes
}

// Fonction pour le menu déroulant sur mobile
function setupDropdownMenu() {
    const menuToggle = document.querySelector('.menu-toggle');
    const navLinks = document.querySelector('.nav-links');

    if (menuToggle && navLinks) {
        menuToggle.addEventListener('click', () => {
            navLinks.classList.toggle('active');
        });
    }
}

// Fonction pour la galerie de vignettes produits
function setupProductGallery() {
    const mainImage = document.getElementById('main-product-image');
    const thumbnails = document.querySelectorAll('.thumbnail-gallery .thumbnail');

    if (mainImage && thumbnails.length > 0) {
        thumbnails.forEach(thumbnail => {
            thumbnail.addEventListener('click', () => {
                const newImageSrc = thumbnail.src.replace('_thumb.jpg', '.jpg');
                mainImage.src = newImageSrc;
            });
        });
    }
}

// Fonction pour afficher les produits sur la page boutique
function displayProducts() {
    const productsContainer = document.querySelector('.product-container');
    if (!productsContainer) return;

    const products = [
        { id: '1', name: 'Veste en Cuir', price: '499,99 €', image: 'images/vetement_1.jpg' },
        { id: '2', name: 'Pantalon Cargo', price: '129,99 €', image: 'images/vetement_2.jpg' },
        { id: '3', name: 'Sweat à Capuche', price: '89,99 €', image: 'images/vetement_3.jpg' },
        { id: '4', name: 'T-shirt Basique', price: '49,99 €', image: 'images/vetement_4.jpg' },
        { id: '5', name: 'Baskets Urbaines', price: '159,99 €', image: 'images/vetement_5.jpg' },
        { id: '6', name: 'Casquette Brodée', price: '39,99 €', image: 'images/vetement_6.jpg' },
    ];

    productsContainer.innerHTML = '';

    products.forEach(product => {
        const productElement = document.createElement('a');
        productElement.href = `produit.html?id=${product.id}`;
        productElement.classList.add('product');
        productElement.innerHTML = `
            <img src="${product.image}" alt="${product.name}">
            <div class="product-info-text">
                <h3>${product.name}</h3>
                <p>${product.price}</p>
            </div>
        `;
        productsContainer.appendChild(productElement);
    });
}

// Fonction pour charger les détails d'un produit
function loadProductDetails() {
    const productDetailsContainer = document.querySelector('.product-details-container');
    if (!productDetailsContainer) return;

    const products = [
        { id: '1', name: 'Veste en Cuir Élégante', price: '499,99 €', description: 'Confectionnée à la main avec un cuir de première qualité, cette veste allie l\'héritage du streetwear et un savoir-faire artisanal. Une pièce intemporelle pour un style affirmé.', image: 'images/vetement_1.jpg' },
        { id: '2', name: 'Pantalon Cargo Moderne', price: '129,99 €', description: 'Un pantalon polyvalent, pensé pour le mouvement et le confort. Ses multiples poches et sa coupe contemporaine en font un indispensable de votre dressing.', image: 'images/vetement_2.jpg' },
        { id: '3', name: 'Sweat à Capuche Luxueux', price: '89,99 €', description: 'Le parfait équilibre entre confort et élégance. Fabriqué en coton ultra-doux, ce sweat est rehaussé de détails discrets qui le rendent unique.', image: 'images/vetement_3.jpg' },
        { id: '4', name: 'T-shirt Basique Sophistiqué', price: '49,99 €', description: 'Un classique revisité pour une qualité irréprochable. Ce T-shirt est coupé dans un jersey de coton épais, offrant un tombé parfait et une durabilité exceptionnelle.', image: 'images/vetement_4.jpg' },
        { id: '5', name: 'Baskets Urbaines Premium', price: '159,99 €', description: 'Légères et robustes, ces baskets sont conçues pour la vie urbaine. Leur design minimaliste s\'associe à une semelle amortissante pour un confort absolu.', image: 'images/vetement_5.jpg' },
        { id: '6', name: 'Casquette Brodée Signature', price: '39,99 €', description: 'Une casquette qui exprime votre style avec élégance. Confectionnée dans un twill de coton, elle arbore un logo brodé pour une finition soignée.', image: 'images/vetement_6.jpg' },
    ];

    const urlParams = new URLSearchParams(window.location.search);
    const productId = urlParams.get('id');

    const product = products.find(p => p.id === productId);

    if (product) {
        document.querySelector('.product-info h2').textContent = product.name;
        document.querySelector('.product-info .price').textContent = product.price;
        document.querySelector('.product-info .description').textContent = product.description;
        document.getElementById('main-product-image').src = product.image;
    } else {
        productDetailsContainer.innerHTML = '<h2>Produit non trouvé</h2>';
    }
}

// Fonction pour les animations d'apparition progressives
function setupFadeInOnScroll() {
    const fadeElements = document.querySelectorAll('.product, .product-details-container, .page-content');

    const observer = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
                observer.unobserve(entry.target);
            }
        });
    }, { threshold: 0.1 });

    fadeElements.forEach(element => {
        element.style.opacity = '0';
        element.style.transform = 'translateY(50px)';
        element.style.transition = 'opacity 0.6s ease-out, transform 0.6s ease-out';
        observer.observe(element);
    });
}

// Lancement de toutes les fonctions une fois que la page est chargée
document.addEventListener('DOMContentLoaded', () => {
    startCarousel();
    setupDropdownMenu();
    setupProductGallery();
    displayProducts();
    loadProductDetails();
    setupFadeInOnScroll();
});
